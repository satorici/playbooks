install:
    assertReturnCode: 0
    dependencies:
    - [ apt install -y git ]
    clone:
    - [ git clone https://github.com/satorici/satori-cli.git . ]
    requirements:
    - [ pip install -r requirements.txt ]

input:
  valid:
    - config
    - run
    - upload
    - playbooks
    - stop-report
    - status
    - cron
    - scan
    - stop
    - info
    - clean
    - report
  invalid:
    - value: config
      mutate: radamsa
      mutate_qty: 10
    - value: run
      mutate: radamsa
      mutate_qty: 10
    - value: upload
      mutate: radamsa
      mutate_qty: 10
    - value: playbooks
      mutate: radamsa
      mutate_qty: 10
    - value: stop-report
      mutate: radamsa
      mutate_qty: 10
    - value: status
      mutate: radamsa
      mutate_qty: 10
    - value: cron
      mutate: radamsa
      mutate_qty: 10
    - value: scan
      mutate: radamsa
      mutate_qty: 10
    - value: stop
      mutate: radamsa
      mutate_qty: 10
    - value: info
      mutate: radamsa
      mutate_qty: 10
    - value: clean
      mutate: radamsa
      mutate_qty: 10
    - value: report
      mutate: radamsa
      mutate_qty: 10

satori-cli:
    assertStderrNotContains: Traceback
    mutated-mutated:
    - [ python3 satori-cli $(input) $(input) ]
