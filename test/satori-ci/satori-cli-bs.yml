install:
    assertReturnCode: 0
    dependencies:
    - [ apt install -y git ]
    clone:
    - [ git clone https://github.com/satorici/satori-cli.git . ]
    requirements:
    - [ pip install -r requirements.txt ]

valid:
    - config
    - run
    - upload
    - playbooks
    - stop-report
    - status
    - cron
    - scan
    - stop
    - info
    - clean
    - report
    - ""

invalid:
    - value: config
      mutate: radamsa
      mutate_qty: 2
    - value: run
      mutate: radamsa
      mutate_qty: 2
    - value: upload
      mutate: radamsa
      mutate_qty: 2
    - value: playbooks
      mutate: radamsa
      mutate_qty: 2
    - value: stop-report
      mutate: radamsa
      mutate_qty: 2
    - value: status
      mutate: radamsa
      mutate_qty: 2
    - value: cron
      mutate: radamsa
      mutate_qty: 2
    - value: scan
      mutate: radamsa
      mutate_qty: 2
    - value: stop
      mutate: radamsa
      mutate_qty: 2
    - value: info
      mutate: radamsa
      mutate_qty: 2
    - value: clean
      mutate: radamsa
      mutate_qty: 2
    - value: report
      mutate: radamsa
      mutate_qty: 2

tracebacks:
    - "scan \xf5config"
    - "stop stop-re\xc2\xb7po\x0c\xf3\xe0\x80\xb2rt"
    - "clean \xcb\x90cle\xf3\xcb\x90clean"

malformed:
    - ".satori/malformed/dev_random.yml"

wellformed:
    - ".satori/wellformed/hola_mundo.yml"

#wellformed_mutated:
#TBC

valid_wellformed:
    wellformed:
    - [ python3 satori-cli $(wellformed) ]

invalid_malformed:
    assertStderrNotContains: Traceback
    valid-invalid:
    - [ python3 satori-cli $(valid) $(invalid) ]
    invalid-valid:
    - [ python3 satori-cli $(invalid) $(valid) ]
    tracebacks:
    - [ python3 satori-cli $(tracebacks) ]
    malformed:
    - [ python3 satori-cli run $(malformed) ]
    # wellformed mutated
    # - [ python3 satori-cli run $(wellformed_mutated) ]
