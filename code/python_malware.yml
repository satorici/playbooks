settings:
  name: Find Python malware v0.1

strings:
  suspicious:
  - 'passw'
  obfuscation:
  - 'b64decode('
  - 'b64encode('
  execution:
  - 'subprocess.Popen'
  - 'os.system'
  - 'shell=True'
  - 'subprocess.getoutput('
  infilexfiltrate:
  - 'requests.get('
  - 'urlretrieve('
  - 'urlopen('
  - 'requests\.Session('
  - 'requests\.post('

grep:
  assertStdout: False
  string:
  - [ grep "$(strings)" * -R ]
