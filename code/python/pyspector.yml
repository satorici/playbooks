settings:
  name: "PySpector Security Analysis"
  description: "SAST security testing of PySpector Python framework"
  image: "satori"
  example: satori run --playbook satori://code/python/pyspector.yml -d REPO=satorici/satori-cli --output

pyspector:
  install:
    - command -v pyspector >/dev/null || pip install -q --root-user-action=ignore --disable-pip-version-check pyspector

  test:
    run:
      - pyspector scan . --ai

    CRITICAL:
      setOutput: pyspector.test.run
      setSeverity: 1
      assertStdoutNotContains: "CRITICAL"

    HIGH:
      setOutput: pyspector.test.run
      setSeverity: 2
      assertStdoutNotContains: "HIGH"

    MEDIUM:
      setOutput: pyspector.test.run
      setSeverity: 3
      assertStdoutNotContains: "MEDIUM"

    LOW:
      setOutput: pyspector.test.run
      setSeverity: 4
      assertStdoutNotContains: "LOW"
