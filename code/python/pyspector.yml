settings:
  name: "PySpector Security Analysis"
  description: "PySpector is a static analysis security testing (SAST) Framework engineered for modern Python development workflows. It leverages a powerful Rust core to deliver high-speed, accurate vulnerability scanning, wrapped in a developer-friendly Python CLI."
  image: juanimedina7/pyspector
  author:
    - https://github.com/ParzivalHack
  example: satori run --playbook satori://code/python/pyspector.yml --repo satorici/satori-cli --output

pyspector:
  install:
    - command -v pyspector >/dev/null || pip install -q --root-user-action=ignore --disable-pip-version-check pyspector

  test:
    run:
      - pyspector scan . --ai

    CRITICAL:
      setOutput: pyspector.test.run
      setSeverity: 1
      assertStdoutNotContains: "CRITICAL"

    HIGH:
      setOutput: pyspector.test.run
      setSeverity: 2
      assertStdoutNotContains: "HIGH"

    MEDIUM:
      setOutput: pyspector.test.run
      setSeverity: 3
      assertStdoutNotContains: "MEDIUM"

    LOW:
      setOutput: pyspector.test.run
      setSeverity: 4
      assertStdoutNotContains: "LOW"
