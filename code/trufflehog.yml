settings:
    name: "Hardcoded Secrets with Trufflehog"
    description: "Files were found containing hardcoded secrets"
    recommendation: "Remove the secrets from the code whenever possible"

install:
    # build:
    # - [ apt-get install git golang -y; git clone https://github.com/trufflesecurity/trufflehog.git ] #; cd trufflehog; go build ; ls -la; ./trufflehog ./ ]
    assertReturnCode: 0
    exec:
    - [ pip install trufflehog3 ]

trufflehog:
    high:
        assertStdoutNotContains: HIGH
        # - severity: 1
        exec:
        - [ trufflehog3 filesystem . --no-entropy -s HIGH | sed -e "s/~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~//" ]
    medium:
        assertStdoutNotContains: MEDIUM
        # - severity: 3
        exec:
        - [ trufflehog3 filesystem . --no-entropy -s MEDIUM | sed -e "s/~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~//" ]
    low:
        assertStdoutNotContains: LOW
        # - severity: 5
        exec:
        - [ trufflehog3 filesystem . --no-entropy -s LOW | sed -e "s/~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~//" ]
