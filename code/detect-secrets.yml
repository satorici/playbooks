settings:
  name: detect-secrets is an aptly named module for detecting secrets within a code base.

install:
  jq:
  - [ apt install -y jq ]
  detect-secrets:
  - [ pip3 install detect-secrets ]

detect-secrets:
  assertStdoutEqual: "{}\n"
  run:
  - [ "detect-secrets scan ./ --all-files | jq -r '.results | to_entries[] | .value[] | \"\(.filename):\(.line_number)\"' > output" ]
  output:
  - [ cat output ]
