settings:
  name: "Search python functions assocaited to command executions and URL requests"
  # example: satori run ./ --playbook="satori://malware/python.yml" --data='{"STRINGS":"string"}' --report

strings:
  suspicious:
  - 'passw'
  obfuscation:
  - 'b64decode('
  - 'b64encode('
  execution:
  - 'subprocess.Popen'
  - 'os.system'
  - 'shell=True'
  - 'subprocess.getoutput('
  infilexfiltrate:
  - 'requests.get('
  - 'urlretrieve('
  - 'urlopen('
  - 'requests\.Session('
  - 'requests\.post('

grep:
  assertStdout: False
  string:
  - "grep \"${{STRINGS}}\" * -R | cut -b -200"
