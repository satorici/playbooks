settings:
  name: "CVE-2025-53770 - SharePoint unauthenticated Remote Code Execution vulnerability"
  image: golang
  example: satori local satori://ms/CVE-2025-53770 -df IPS=ips --output

install:
  - git clone --depth 1 https://github.com/hazcod/CVE-2025-53770.git && cd CVE-2025-53770 && go build -o CVE-2025-53770 ./cmd/...

#run:
#  - cd CVE-2025-53770; ./CVE-2025-53770 127.0.0.1 -log=debug 

CVE-2025-53770:
  setSeverity: 0
  assertStdoutNotContains: 'target is vulnerable'
  run:
    - |
      echo ${{IPS}} | while IFS=',' read -r IP PORT; do
        echo -e "## IP: $IP - Port: $PORT\n\`\`\`"
        ./CVE-2025-53770/CVE-2025-53770 -version $IP 2>&1 | grep -v "set log level\|starting scanner\|error "
        echo -e "\`\`\`\n---"
      done
