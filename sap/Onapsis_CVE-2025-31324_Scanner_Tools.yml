settings:
  name: Scanner for CVE-2025-31324 SAP NetWeaver
  description: "Onapsis Scanner for Vulnerability CVE-2025-31324 (SAP Security 3594142) - CVSS 10 (Critical). This tool checks for the presence of the vulnerability and known webshells in the SAP system. \n\nDISCLAIMER: This tool is provided from Onapsis via open source license Apache 2.0, as a contribution to the security, incident response, and SAP communities to aid in response to active exploitation of CVE-2025-31324. This tool is under development and will continue to iterate rapidly as more information becomes available either from Onapsis Research Labs or publicly. This is a best-effort development and offered as-is with no warranty or liability."
  image: python
  author: 
    - https://github.com/Onapsis
  example: satori run satori://sap/Onapsis_CVE-2025-31324_Scanner_Tools.yml -d IP=127.0.0.1 -d PORT=50000 --output --report

install:
  - cd /tmp; git clone --depth 1 https://github.com/Onapsis/Onapsis_CVE-2025-31324_Scanner_Tools.git && cd Onapsis_CVE-2025-31324_Scanner_Tools && pip install -r requirements.txt --disable-pip-version-check --root-user-action=ignore --break-system-packages -q

Onapsis_CVE-2025-31324_Scanner_Tools:
  setSeverity: 5
  assertStdoutNotContains: 'CRITICAL'
  run:
    - |
      echo "# CVE-2025-31324 - SAP NetWeaver Visual Composer Metadata Uploader"
      while read HOST; do
        IP=$(echo $HOST | awk -F',' '{print $1}')
        PORT=$(echo $HOST | awk -F',' '{print $2}')
        echo "## IP: $IP - PORT: $PORT"
        python3 /tmp/Onapsis_CVE-2025-31324_Scanner_Tools/Onapsis-Scanner-CVE-2025-31324.py $IP $PORT | grep -v ERROR
        echo "---"
      done<"${{IPS}}"
