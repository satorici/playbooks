settings:
  name: Scanner for CVE-2025-31324 SAP NetWeaver
  description: "Onapsis Scanner for Vulnerability CVE-2025-31324 (SAP Security 3594142) - CVSS 10 (Critical). This tool checks for the presence of the vulnerability and known webshells in the SAP system. \n\nDISCLAIMER: This tool is provided from Onapsis via open source license Apache 2.0, as a contribution to the security, incident response, and SAP communities to aid in response to active exploitation of CVE-2025-31324. This tool is under development and will continue to iterate rapidly as more information becomes available either from Onapsis Research Labs or publicly. This is a best-effort development and offered as-is with no warranty or liability."
  image: python
  author: 
    - https://github.com/Onapsis
  example: satori run satori://sap/Onapsis_CVE-2025-31324_Scanner_Tools.yml -df IPS=ips --output

install:
  - cd /tmp; git clone --depth 1 https://github.com/Onapsis/Onapsis_CVE-2025-31324_Scanner_Tools.git onap && cd onap && pip install -r requirements.txt --disable-pip-version-check --root-user-action=ignore --break-system-packages -q && cp Onapsis-Scanner-CVE-2025-31324.py run.py

Onapsis_CVE-2025-31324_Scanner_Tools:
  setSeverity: 5
  assertStdoutNotContains: 'CRITICAL'
  run:
    - |
      echo ${{IPS}} | while IFS=',' read -r IP PORT; do
        echo "## IP: $IP - PORT: $PORT"
        echo ""
        python3 /tmp/onap/run.py "$IP" "$PORT" | grep -v ERROR
        echo "---"
      done
