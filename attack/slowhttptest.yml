install:
  assertReturnCode: 0
  slowhttptest:
  - [ apt install -y slowhttptest ]

host:
  assertReturnCode: 0

  before_slowhttptest:
  - [ curl -s https://$(HOST) -w 3 ]

  slowhttptest:
  - [ slowhttptest -c 1000 -g -o slowloris_test_get_h -i 110 -r 200 -s 8192 -t GET -x 10 -p 3 -u https://$(HOST) ]
  - [ slowhttptest -c 1000 -g -o slowloris_test_get_h -i 110 -r 200 -s 8192 -t GET -x 10 -p 3 -u https://$(HOST) -H ]
  - [ slowhttptest -c 1000 -g -o slowloris_test_get_x -i 110 -r 200 -s 8192 -t GET -x 10 -p 3 -u https://$(HOST) -X ]
  - [ slowhttptest -c 1000 -g -o slowloris_test_get_b -i 110 -r 200 -s 8192 -t GET -x 10 -p 3 -u https://$(HOST) -B ]
  - [ slowhttptest -c 1000 -g -o slowloris_test_get_r -i 110 -r 200 -s 8192 -t GET -x 10 -p 3 -u https://$(HOST) -R ]
  - [ slowhttptest -c 1000 -g -o slowloris_test_post_h -i 110 -r 200 -s 8192 -t POST -x 10 -p 3 -u https://$(HOST) -H ]
  - [ slowhttptest -c 1000 -g -o slowloris_test_post_x -i 110 -r 200 -s 8192 -t POST -x 10 -p 3 -u https://$(HOST) -X ]
  - [ slowhttptest -c 1000 -g -o slowloris_test_post_b -i 110 -r 200 -s 8192 -t POST -x 10 -p 3 -u https://$(HOST) -B ]
  - [ slowhttptest -c 1000 -g -o slowloris_test_post_r -i 110 -r 200 -s 8192 -t POST -x 10 -p 3 -u https://$(HOST) -R ]

  after_slowhttptest:
  - [ curl -s https://$(HOST) -w 3 ]
