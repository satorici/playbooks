settings:
  name: "Run siege with an ever-increasing number of users"
  description: "Siege is an regression test and benchmark utility. It can stress test a single URL with a user defined number of simulated users, or it can read many URLs into memory and stress them simultaneously. The program reports the total number of hits recorded, bytes transferred, response time, concurrency, and return status. Siege supports HTTP/1.0 and 1.1 protocols, the GET and POST directives, cookies, transaction logging, and basic authentication. Its features are configurable on a per user basis."

install:
  assertReturnCode: 0

  siege:
  - [ apt install -y siege ]
  url_file:
  - [ "echo \"$(URL)\" > url" ]

host:
  assertReturnCode: 0

  before_bombardment:
  - [ curl -s $(URL) -m 10 ]

  bombardment:
  - [ bombardment url 100 5 3 1 ]

  after_bombardment:
  - [ curl -s $(URL) -m 10 ]
