settings:
  name: "CVE-2025-20352 (CVSS 7.7): SNMP vulnerability in Cisco" 
  description: "A vulnerability in the Simple Network Management Protocol (SNMP) subsystem of Cisco IOS Software and Cisco IOS XE Software could allow the following: An authenticated, remote attacker with low privileges could cause a denial of service (DoS) condition on an affected device that is running Cisco IOS Software or Cisco IOS XE Software. To cause the DoS, the attacker must have the SNMPv2c or earlier read-only community string or valid SNMPv3 user credentials. An authenticated, remote attacker with high privileges could execute code as the root user on an affected device that is running Cisco IOS XE Software. To execute code as the root user, the attacker must have the SNMPv1 or v2c read-only community string or valid SNMPv3 user credentials and administrative or privilege 15 credentials on the affected device. An attacker could exploit this vulnerability by sending a crafted SNMP packet to an affected device over IPv4 or IPv6 networks. This vulnerability is due to a stack overflow condition in the SNMP subsystem of the affected software. A successful exploit could allow a low-privileged attacker to cause the affected system to reload, resulting in a DoS condition, or allow a high-privileged attacker to execute arbitrary code as the root user and obtain full control of the affected system. Note: This vulnerability affects all versions of SNMP."
  image: python
  author:
    - https://github.com/scadastrangelove
  example: satori run satori://cve/CVE-2025-20352.yml -d HOST=127.0.0.1 --output

CVE-2025-20352:
  install:
    - command -v git && command -v wget && command -v make && command -v gcc && command -v snmpget && command -v column && command -v unzip || (DEBIAN_FRONTEND=noninteractive apt-get update >>/dev/null && DEBIAN_FRONTEND=noninteractive apt-get install -y git wget build-essential snmp bsdmainutils unzip >>/dev/null 2>&1)
    - command -v onesixtyone || (cd /tmp && wget -q https://github.com/trailofbits/onesixtyone/archive/master.zip && unzip -q master.zip && cd onesixtyone-master && make >>/dev/null && cp onesixtyone /usr/local/bin/)
    - test -d /tmp/CVE-2025-20352 || (cd /tmp; git clone --depth 1 https://github.com/scadastrangelove/CVE-2025-20352 CVE-2025-20352)
    - test -f /tmp/communities.txt || printf "public\nprivate\n" > /tmp/communities.txt

  test:
    assertStdoutContains: Vulnerable
    run:
      - onesixtyone -c /tmp/communities.txt ${{HOST}} | tee snmp_raw.txt
      - python3 /tmp/CVE-2025-20352/ios_cve20352_parser.py < snmp_raw.txt > parsed.csv; column -s, -t < parsed.csv
