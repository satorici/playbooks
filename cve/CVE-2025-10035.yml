settings:
  name: "CVE-2025-10035 - GoAnywhere MFT RCE"
  description: "Detects vulnerable GoAnywhere MFT instances by extracting version numbers from the login page and matching against affected version ranges."
  example: satori run satori://cve/CVE-2025-10035.yml -d HOST=127.0.0.1 --output

httpx1:
  - which httpx
  - httpx -version
  - /usr/local/bin/httpx -version
  
install:
  - (which wget && which unzip) || (apt-get update >/dev/null 2>&1 && apt-get install -y wget unzip >/dev/null 2>&1)
  - which nuclei >/dev/null || (cd /tmp && wget -q $(curl -s https://api.github.com/repos/projectdiscovery/nuclei/releases/latest | grep "browser_download_url.*linux_amd64.zip" | cut -d '"' -f 4) && unzip -q nuclei_*_linux_amd64.zip && mv nuclei /usr/local/bin/ && chmod +x /usr/local/bin/nuclei && mkdir -p /root/.config/nuclei && touch /root/.config/nuclei/.nuclei-ignore)
  - which httpx >/dev/null || (cd /tmp && wget -q $(curl -s https://api.github.com/repos/projectdiscovery/httpx/releases/latest | grep "browser_download_url.*linux_amd64.zip" | cut -d '"' -f 4) && unzip -q httpx_*_linux_amd64.zip && mv httpx /usr/local/bin/ && chmod +x /usr/local/bin/httpx)
  - test -f /tmp/CVE-2025-10035.yaml || wget -q https://raw.githubusercontent.com/rxerium/CVE-2025-10035/refs/heads/main/CVE-2025-10035.yaml -O /tmp/CVE-2025-10035.yaml

httpx2:
  - which httpx
  - httpx -version
  - /usr/local/bin/httpx -version

CVE-2025-10035:
  setSeverity: 1
  assertStdoutNotContains: 'critical'
  run:
    - echo "${{HOST}}" | httpx -ports ${{PORT}} -silent -verbose | tee /tmp/httpx_output.txt
    - echo "=== HTTPX Results ==="
    - cat /tmp/httpx_output.txt
    - echo "=== Running nuclei on results ==="
    - cat /tmp/httpx_output.txt | nuclei -t /tmp/CVE-2025-10035.yaml -disable-update-check
