settings:
  image: ubuntu:jammy
  name: "MassDNS: enumerates DNS records"
  author:
    - https://github.com/blechschmidt
  gallery:
    - https://files.catbox.moe/54vy1l.gif
  #example: satori run satori://dns/massdns.yml --data='{"DOMAIN": "satori.ci"}' --output
install:
  assertReturnCode: 0
  update:
    - apt update
  dependencies:
    - apt install git make gcc -qy
  clone:
    - git clone --depth 1 https://github.com/blechschmidt/massdns.git
    - cd massdns && make
  dom:
    - echo "${{DOMAIN}}" > domain.txt

run:
  assertReturnCode: 0
  help:
    - ./massdns/bin/massdns --help
  run:
    - for record_type in A AAAA MX NS TXT CNAME SOA SRV PTR SPF; do ./massdns -r massdns/lists/resolvers.txt -t $record_type -o F -w output_${record_type}.txt domain.txt; done
    - cat output_*.txt
    # - ./massdns/bin/massdns -r massdns/lists/resolvers.txt -t AAAA domain.txt
