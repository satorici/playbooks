settings:
  name: "Multi-cloud security-auditing tool that gathers configuration data for manual inspection and highlights risk areas."

install:
  scoutsuite:
  - [ pip install scoutsuite ]
  jq:
  - [ apt install -qq -y jq ]

scout:
  run:
  - [ scout aws --access-key-id $(KEY_ID) --secret-access-key $(KEY_SECRET) ]
  output:
  - [ "set +f; cat scoutsuite-report/scoutsuite-results/scoutsuite_results_aws-*.js" ]
  results:
    assertStdout: False
    danger:
    - [ "tail -n +2 scoutsuite-report/scoutsuite-results/scoutsuite_results_aws-*.js | jq '.services[].findings[] | select(.level == \"danger\")'" ]
    # warning:
    # - [ "tail -n +2 scoutsuite-report/scoutsuite-results/scoutsuite_results_aws-*.js | jq '.services[].findings[] | select(.level == \"warning\")'" ]
